<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>MicroPython in Browser</title>
</head>
<body>
  <h1>MicroPython Test</h1>
  <pre id="output"></pre>

  <script type="module">
    import createMicroPythonModule from './micropython.mjs';

    async function runMicroPython() {
      const outputEl = document.getElementById('output');
      
      // Create and initialize MicroPython module
      const mpModule = await createMicroPythonModule();
      
      // Initialize MicroPython runtime
      mpModule._mp_js_init();
      mpModule._mp_js_repl_init();

      // Setup capturing output
      let output = '';
      mpModule.print = function (text) {
        output += text + '\n';
      };

      // Code you want to run
      const code = `
print("Hello from MicroPython!")
for i in range(5):
    print("Number:", i)
`;

      // Feed the code character by character
      for (const c of code) {
        mpModule._mp_js_repl_process_char(c.charCodeAt(0));
      }

      // Display output
      outputEl.textContent = output;
    }

    runMicroPython();
  </script>
</body>
</html>
